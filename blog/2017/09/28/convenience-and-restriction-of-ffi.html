<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:html="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/css/main.css"/><link rel="shortcut icon" href="/images/favicon.png"/><title>FFI的便利性和局限性</title></head><body><header><span id="site-name"><a href="/">dram.me</a></span><nav><ul><li><a href="/blog/about.html">About</a></li><li><a href="/logo/">LOGO</a></li></ul></nav></header><article><h1>FFI的便利性和局限性</h1><time>28 Sep 2017</time>


<p>尝试利用LuaJIT的FFI对接C的<code>connect</code>接口，发现其中<code>sockaddr</code>结构体的定义有很多层次的嵌套，很难在保证各平台可移植性的基础上简单完成接口封装。</p>
<p>相对来说，这种情况下，反而直接编写Lua模块更为直接。</p>
<p>当然，另一种方案是类似CHICKEN、Gambit的机制，由于语言实现是间接编译到C代码，所以可以直接内嵌C代码。</p>
<p>还有一种思路，是C++，几乎完全兼容C标准。</p>
</article><footer><p>Copyright © 2007–2018 Xin Wang</p></footer></body></html>
