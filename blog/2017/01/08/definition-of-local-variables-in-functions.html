<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:html="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/css/main.css"/><link rel="shortcut icon" href="/images/favicon.png"/><title>函数局部变量的定义位置</title></head><body><header><span id="site-name"><a href="/">dram.me</a></span><nav><ul><li><a href="/blog/about.html">About</a></li><li><a href="/logo/">LOGO</a></li></ul></nav></header><article><h1>函数局部变量的定义位置</h1><time>08 Jan 2017</time>

<section class="topic">
<h2>补遗</h2>
<p>更早的代码块内起始定义变量的例子是ALGOL 60。—— 2017-01-10</p>
</section>
<p>对于函数内部局部变量的位置，不同语言有不同的处理。</p>
<p>比如Modula-2以及Oberon中，只在过程定义开始部分的<code>VAR</code>段允许定义变量。同样Smalltalk也只支持在方法的头部定义局部变量。</p>
<p>C语言早期只支持在代码块的开始声明变量，在<a href="https://en.wikipedia.org/wiki/C99">C99</a>之后允许在代码块任意位置声明。</p>
<p>再如JavaScript早期的<code>var</code>变量声明虽然可以在代码块任意位置，但是会被<a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/var#var_hoisting">自动提前</a>，新近在ECMAScript 6中引入了<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let">let定义</a>的模式对此做了完整的支持。</p>
<p>单从语言功能的发展来看，C和JavaScript是解除了语言的限制，给予程序员更多的自由。但另一方面，感觉这一自由与“让函数尽量短小”的编码原则是有点相背的。</p>
<p>这要从最初的问题开始分析。</p>
<p>在函数体较长时，如果变量的声明和使用距离太远，会导致理解上的困难。C和JS处理这一问题的思路是把变量的定义放到第一次使用的地方。但还有另外一种解决的思路，就是把函数拆分，使得其足够短小，不至于影响阅读。</p>
<p>从这一角度上说，限制反而增进的代码的可读性。</p>
</article><footer><p>Copyright © 2007–2018 Xin Wang</p></footer></body></html>
