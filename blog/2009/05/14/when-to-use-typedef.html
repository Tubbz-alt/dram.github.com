<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:html="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/css/main.css"/><link rel="shortcut icon" href="/images/favicon.png"/><title>什么时候用 typedef</title></head><body><header><span id="site-name"><a href="/">dram.me</a></span><nav><ul><li><a href="/blog/about.html">About</a></li><li><a href="/logo/">LOGO</a></li></ul></nav></header><article><h1>什么时候用 typedef</h1><time>14 May 2009</time>

<p>最近 NetBSD 里将大量的<code>struct device *</code>用<code>device_t</code>代替，但没有怎么说明原因。</p>
<p>只记得在 Linux Kernel Coding Style 中对 typedef 还是不怎么提倡使用的，于是又重新翻了一下这份文档，发现这大概和下面这种情况比较相符：</p>
<blockquote>
<p>totally opaque objects (where the typedef is actively used to <em>hide</em> what the object is). Example: "pte<em>t" etc. opaque objects that you can only access using the proper accessor functions. NOTE! Opaqueness and "accessor functions" are not good in themselves. The reason we have them for things like pte</em>t etc. is that there really is absolutely <em>zero</em> portably accessible information there.</p>
</blockquote>
<p>猜想用<code>device_t</code>代替的用意是在使用这一类型时不用关心它的成员，这也算一种合理的隐藏吧。</p>
</article><footer><p>Copyright © 2007–2017 Xin Wang</p></footer></body></html>
